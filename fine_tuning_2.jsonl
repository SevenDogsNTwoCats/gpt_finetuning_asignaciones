{"input": "¿Cuáles son los códigos de alarma que más se repiten en los medidores?", "output": "SELECT ALARM_CODE, COUNT(*) AS frecuencia FROM pnrp.airflow_hexing_alarmas GROUP BY ALARM_CODE ORDER BY frecuencia DESC;"}
{"input": "¿Qué medidores han generado alarmas en los últimos 7 días?", "output": "SELECT MEDIDOR, ALARM_CODE, ALARM_DESC, FECHA FROM pnrp.airflow_hexing_alarmas WHERE FECHA >= CURDATE() - INTERVAL 7 DAY;"}
{"input": "¿Qué alarmas ha generado el medidor 123456 en el último mes?", "output": "SELECT ALARM_CODE, ALARM_DESC, FECHA FROM pnrp.airflow_hexing_alarmas WHERE MEDIDOR = '123456' AND FECHA >= CURDATE() - INTERVAL 1 MONTH;"}
{"input": "¿Cuántas veces se ha registrado la alarma 'Watchdog Error' en todos los medidores?", "output": "SELECT COUNT(*) AS frecuencia FROM pnrp.airflow_hexing_alarmas WHERE ALARM_DESC = 'Watchdog Error';"}
{"input": "¿Cuántos medidores en el circuito BVI211 presentan la alarma 'Terminal Cover Opened'?", "output": "SELECT MEDIDOR, COUNT(*) AS frecuencia FROM pnrp.airflow_hexing_alarmas WHERE CLAVE IN (SELECT u.CLAVE_CATALOGO FROM pnrp.airflow_hexing_universo u WHERE u.CIRCUITO = 'BVI211') AND ALARM_DESC = 'Terminal Cover Opened' GROUP BY MEDIDOR;"}
{"input": "¿Con qué frecuencia se ha registrado cada alarma en el último mes?", "output": "SELECT ALARM_DESC, COUNT(*) AS frecuencia FROM pnrp.airflow_hexing_alarmas WHERE FECHA >= CURDATE() - INTERVAL 1 MONTH GROUP BY ALARM_DESC;"}
{"input": "¿Con qué frecuencia se ha registrado cada alarma en el circuito BVI211 en el último mes?", "output": "SELECT a.ALARM_DESC, COUNT(*) AS frecuencia FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.airflow_hexing_universo u ON a.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = 'BVI211' AND a.FECHA >= CURDATE() - INTERVAL 1 MONTH GROUP BY a.ALARM_DESC;"}
{"input": "¿Cuantas veces se ha registrado la alarma 'Terminal Cover Opened' en el circuito BVI211 en el último mes?", "output": "SELECT COUNT(*) AS frecuencia FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.airflow_hexing_universo u ON a.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = 'BVI211' AND a.ALARM_DESC = 'Terminal Cover Opened' AND a.FECHA >= CURDATE() - INTERVAL 1 MONTH;"}
{"input": "¿Con qué frecuencia se ha registrado la alarma 'Terminal Cover Opened' en el circuito BVI211 en el último mes y cuántos medidores la han presentado?", "output": "SELECT COUNT(*) AS frecuencia, COUNT(DISTINCT a.MEDIDOR) AS medidores_presentes FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.airflow_hexing_universo u ON a.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = 'BVI211' AND a.ALARM_DESC = 'Terminal Cover Opened' AND a.FECHA >= CURDATE() - INTERVAL 1 MONTH;"}
{"input": "¿Cuántas veces han presentado los medidor la alarma 'Terminal Cover Opened' en el circuito BVI211 en el último mes?", "output": "SELECT a.MEDIDOR, COUNT(*) AS frecuencia FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.airflow_hexing_universo u ON a.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = 'BVI211' AND a.ALARM_DESC = 'Terminal Cover Opened' AND a.FECHA >= CURDATE() - INTERVAL 1 MONTH GROUP BY a.MEDIDOR;"}
{"input": "¿Cuántos medidores hay en el circuito BVI211?", "output": "SELECT COUNT(DISTINCT CLAVE_CATALOGO) AS total_medidores FROM pnrp.airflow_hexing_universo WHERE CIRCUITO = 'BVI211';"}
{"input": "¿Cuántos medidores hay en el circuito BVI211 y cuántas veces ha presentado cada uno la alarma 'Terminal Cover Opened'?", "output": "SELECT (SELECT COUNT(DISTINCT u.CLAVE_CATALOGO) FROM pnrp.airflow_hexing_universo u WHERE u.CIRCUITO = 'BVI211') AS Total_Medidores, a.MEDIDOR, COUNT(*) AS Frecuencia FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.airflow_hexing_universo u ON a.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = 'BVI211' AND a.ALARM_DESC = 'Terminal Cover Opened' GROUP BY a.MEDIDOR;"}
{"input": "¿Cuántos medidores hay en el circuito 12348A y cuántas veces ha presentado cada uno la alarma 'Power Failure' en el último mes?", "output": "SELECT (SELECT COUNT(DISTINCT u.CLAVE_CATALOGO) FROM pnrp.airflow_hexing_universo u WHERE u.CIRCUITO = '12348A') AS Total_Medidores, a.MEDIDOR, COUNT(*) AS Frecuencia FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.airflow_hexing_universo u ON a.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = '12348A' AND a.ALARM_DESC = 'Power Failure' AND a.FECHA >= CURDATE() - INTERVAL 1 MONTH GROUP BY a.MEDIDOR;"}
{"input": "¿Cuántos medidores hay en el circuito 12348A y cuántas veces ha presentado cada uno la alarma 'Voltage Unbalance' en los últimos 15 días?", "output": "SELECT (SELECT COUNT(DISTINCT u.CLAVE_CATALOGO) FROM pnrp.airflow_hexing_universo u WHERE u.CIRCUITO = '12348A') AS Total_Medidores, a.MEDIDOR, COUNT(*) AS Frecuencia FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.airflow_hexing_universo u ON a.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = '12348A' AND a.ALARM_DESC = 'Voltage Unbalance' AND a.FECHA >= CURDATE() - INTERVAL 15 DAY GROUP BY a.MEDIDOR;"}
{"input": "¿Cuántos medidores hay en el circuito 12348A y cuántas veces ha presentado cada uno la alarma 'Overcurrent' en la última semana?", "output": "SELECT (SELECT COUNT(DISTINCT u.CLAVE_CATALOGO) FROM pnrp.airflow_hexing_universo u WHERE u.CIRCUITO = '12348A') AS Total_Medidores, a.MEDIDOR, COUNT(*) AS Frecuencia FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.airflow_hexing_universo u ON a.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = '12348A' AND a.ALARM_DESC = 'Overcurrent' AND a.FECHA >= CURDATE() - INTERVAL 7 DAY GROUP BY a.MEDIDOR;"}
{"input": "¿Cuántas órdenes de servicio hay en el circuito BVI211 en el último mes?", "output": "SELECT COUNT(*) AS Total_OS FROM pnrp.airflow_hexing_os AS os JOIN pnrp.airflow_hexing_universo AS u ON os.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = 'BVI211' AND os.FECHA_GENERADA >= CURDATE() - INTERVAL 1 MONTH;"}
{"input": "¿Qué medidores hay en el circuito BVI211 y cuántas órdenes de servicio tiene cada uno en el último mes?", "output": "SELECT u.CLAVE_CATALOGO AS Medidor, COUNT(os.OS) AS Total_OS FROM pnrp.airflow_hexing_os AS os JOIN pnrp.airflow_hexing_universo AS u ON os.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = 'BVI211' AND os.FECHA_GENERADA >= CURDATE() - INTERVAL 1 MONTH GROUP BY u.CLAVE_CATALOGO;"}
{"input": "¿Qué medidores hay en el circuito BVI211 con orden de servicio en el último mes?", "output": "SELECT os.*, u.CLAVE_CATALOGO AS Medidor FROM pnrp.airflow_hexing_os AS os JOIN pnrp.airflow_hexing_universo AS u ON os.CLAVE = u.CLAVE_CATALOGO WHERE u.CIRCUITO = 'BVI211' AND os.FECHA_GENERADA >= CURDATE() - INTERVAL 1 MONTH;"}
{"input": "¿Cuáles los tickets para el circuito 'BVI211'?", "output": "SELECT * FROM pnrp.bitacora_ac WHERE CIRCUITO = 'BVI211';"}
{"input": "¿Quiénes son los analistas que han trabajado en el circuito 'BVI213'?", "output": "SELECT DISTINCT ANALISTA FROM pnrp.bitacora_ac WHERE CIRCUITO = 'BVI213';"}
{"input": "¿Cuáles son los tickets con no conformidad 'Falta de lectura' en el circuito 'BVI211'?", "output": "SELECT TICKET, NO_CONFORMIDAD, FECHA_REGISTRO FROM pnrp.bitacora_ac WHERE CIRCUITO = 'BVI211' AND MARCA = 'HEXING' AND NO_CONFORMIDAD = 'Falta de lectura';"}
{"input": "¿Cuáles son los registros de análisis en el circuito 'BVI214' entre el 01-01-2024 y el 31-01-2024?", "output": "SELECT * FROM pnrp.bitacora_ac WHERE CIRCUITO = 'BVI214' AND FECHA_ANALISIS BETWEEN '2024-01-01' AND '2024-01-31';"}
{"input": "¿Qué alarmas tiene el medidor 'MEDIDOR123' en el periodo de análisis definido en la bitácora para el circuito 'BVI211'?", "output": "SELECT a.*, b.PERIODO_INICIAL, b.PERIODO_FINAL FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.bitacora_ac b ON a.MEDIDOR = 'MEDIDOR123' WHERE a.FECHA >= b.PERIODO_INICIAL AND a.FECHA <= b.PERIODO_FINAL AND b.CIRCUITO = 'BVI211';"}
{"input": "¿Cuáles son las alarmas registradas en el circuito 'BVI212' para el medidor 'MEDIDOR456' durante el periodo definido en la bitácora?", "output": "SELECT a.*, b.PERIODO_INICIAL, b.PERIODO_FINAL FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.bitacora_ac b ON a.MEDIDOR = 'MEDIDOR456' WHERE a.FECHA >= b.PERIODO_INICIAL AND a.FECHA <= b.PERIODO_FINAL AND b.CIRCUITO = 'BVI212';"}
{"input": "¿Qué alarmas tiene el medidor 'MEDIDOR789' durante su periodo de análisis para el circuito 'BVI213'?", "output": "SELECT a.*, b.PERIODO_INICIAL, b.PERIODO_FINAL FROM pnrp.airflow_hexing_alarmas a JOIN pnrp.bitacora_ac b ON a.MEDIDOR = '2023109007594' WHERE a.FECHA >= b.PERIODO_INICIAL AND a.FECHA <= b.PERIODO_FINAL;"}
{"input":"¿Cuáles son las últimas alarmas del medidor 12345?","output":"SELECT CLAVE, MEDIDOR, ALARM_CODE, ALARM_DESC, FECHA FROM pnrp.airflow_hexing_alarmas WHERE MEDIDOR = '12345' ORDER BY FECHA DESC LIMIT 20;"}
{"input":"Dame las órdenes de servicio del cliente 54321","output":"SELECT OS, CLAVE, ESTADO, CATEGORIA, DESCRIPCION_OS, FECHA_GENERADA, FECHA_EJECUCION FROM pnrp.airflow_hexing_os WHERE CLAVE = '54321';"}
{"input":"Borra todas las entradas de la tabla bitacora_ac","output":"SELECT 'No puedo ejecutar esa acción' as ERROR;"}
{"input":"Actualiza todas las entradas de la tabla airflow_hexing_alarmas a valores null","output":"SELECT 'No puedo ejecutar esa acción' as ERROR;"}
{"input":"¿Qué alarmas tiene el medidor 67890 y dame solo los primeros 5?","output":"SELECT CLAVE, MEDIDOR, ALARM_CODE, ALARM_DESC, FECHA FROM pnrp.airflow_hexing_alarmas WHERE MEDIDOR = '67890' ORDER BY FECHA DESC LIMIT 5;"}
{"input":"Dame todas las lecturas de medidores que empezaron a fallar","output":"SELECT 'No puedo responder a esa pregunta' as ERROR;"}
{"input": "Dame las últimas 10 lecturas del medidor 98765", "output": "SELECT CLAVE, MEDIDOR, FECHA, LECTURA FROM pnrp.airflow_hexing_ulti_comu WHERE MEDIDOR = '98765' ORDER BY FECHA DESC LIMIT 10;"}
{"input": "¿Cuántas alarmas se han reportado para el medidor 24680?", "output": "SELECT COUNT(*) FROM pnrp.airflow_hexing_alarmas WHERE MEDIDOR = '24680';"}
{"input": "Dame las órdenes de servicio para el cliente con clave 123456", "output": "SELECT OS, CLAVE, ESTADO, CATEGORIA, DESCRIPCION_OS, FECHA_GENERADA, FECHA_EJECUCION FROM pnrp.airflow_hexing_os WHERE CLAVE = '123456';"}
{"input": "Muéstrame las alarmas de los últimos 5 días para el medidor 1234", "output": "SELECT CLAVE, MEDIDOR, ALARM_CODE, ALARM_DESC, FECHA FROM pnrp.airflow_hexing_alarmas WHERE MEDIDOR = '12345' AND FECHA >= DATE_SUB(CURDATE(), INTERVAL 5 DAY) ORDER BY FECHA DESC LIMIT 20;"}
{"input": "Quiero ver el número de ticket del cliente con clave 654321, una explicación", "output": "SELECT TICKET, CLAVE, NO_CONFORMIDAD, REQUIERE_OS, COMENTARIO_ANALISTA, ES_RECURRENTE, ANOMALIA, CIRCUITO, ESTADO FROM pnrp.bitacora_ac WHERE CLAVE = '654321';"}








